---
import { defaultLang } from '../i18n/ui';


const lang = Astro.cookies.get('lang')?.value || defaultLang;
---

<!doctype html>
<html lang={lang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/logo-2.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>Juan Cruz Leone | Portfolio</title>
	</head>
	<body class="bg-principal">
		<div class="max-w-[1000px] mx-auto mt-10 px-4">
			<header>
				<nav class="border border-contenedor bg-transparent rounded-md p-6 pl-4">
					<div class="flex justify-between items-center">
						<ul class="flex justify-left flex-wrap">
							<li>
								<a href="#home" class="text-white font-montserrat font-medium text-base m-6 hover:border-b-[2px] border-celeste ml-0" data-i18n="nav.home"></a>
							</li>
							<li>
								<a href="#about-me" class="text-white font-montserrat font-medium text-base m-6 hover:border-b-[2px] border-celeste ml-0" data-i18n="nav.aboutme"></a>
							</li>
							<li>
								<a href="#skills" class="text-white font-montserrat font-medium text-base m-6 hover:border-b-[2px] border-celeste ml-0" data-i18n="nav.skills"></a>
							</li>
							<li>
								<a href="#projects" class="text-white font-montserrat font-medium text-base m-6 hover:border-b-[2px] border-celeste ml-0" data-i18n="nav.projects"></a>
							</li>
							<li>
								<a href="#contact" class="text-white font-montserrat font-medium text-base m-6 hover:border-b-[2px] border-celeste ml-0" data-i18n="nav.contact"></a>
							</li>
						</ul>
						<div class="flex">
							<div class="border border-contenedor rounded mr-4">
								<a href="">
									<img src="/src/assets/sol.svg" alt="Sol" width="30" height="30" class="p-2">
								</a>
							</div>
							<div class="border border-contenedor rounded">
								<button id="langSwitch">
									<img src="/src/assets/traductor.svg" alt="Traductor" width="30" height="30" class="p-2 pb-0">
								</button>
							</div>
						</div>
					</div>
				</nav>
			</header>
			<slot />
		</div>

		<script>
			import { ui, defaultLang } from '../i18n/ui';

			let currentLang = localStorage.getItem('lang') || '${lang}';

			function switchLanguage() {
				currentLang = currentLang === 'en' ? 'es' : 'en';
				localStorage.setItem('lang', currentLang);
				updateContent();
			}

			function updateContent() {
				document.querySelectorAll('[data-i18n]').forEach(el => {
					const key = el.getAttribute('data-i18n');
					if (key) {
						el.textContent = key.split('.').reduce((obj, k) => obj && obj[k], ui[currentLang]) || key;
					}
				});
				document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
					const key = el.getAttribute('data-i18n-placeholder');
					if (key) {
						el.setAttribute('placeholder', key.split('.').reduce((obj, k) => obj && obj[k], ui[currentLang]) || key);
					}
				});
				document.documentElement.lang = currentLang;
				
				// Dispatch a custom event to notify components of language change
				window.dispatchEvent(new CustomEvent('languagechange', { detail: { lang: currentLang } }));
			}

			document.getElementById('langSwitch').addEventListener('click', switchLanguage);

			// Initial content update
			localStorage.setItem('lang', currentLang);
			document.addEventListener('DOMContentLoaded', updateContent);
		</script>
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		padding: 0;
		width: 100%;
		height: 100%;
		overflow-x: hidden;
	}

	nav ul li a{
		font-weight:300
	}
</style>

